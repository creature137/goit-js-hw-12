{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nasync function fetchImages(query, page) {\n  const apiKey = '45115917-7726aefcae109b05971acac93';\n\n  try {\n    const response = await axios.get('https://pixabay.com/api/', {\n      params: {\n        key: apiKey,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        page,\n        per_page: 15,\n      },\n    });\n\n    return response.data;\n  } catch {\n    throw new Error();\n  }\n}\n\nexport { fetchImages };\n","function displayImages(images, gallery, lightboxGallery) {\n  gallery.insertAdjacentHTML('beforeend', createImageMarkup(images));\n\n  lightboxGallery.refresh();\n}\n\nfunction createImageMarkup(images) {\n  return images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n      <li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n          <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" />\n        </a>\n        <div class=\"gallery-info\">\n          <ul class=\"gallery-details\">\n            ${createImageDetailsMarkup(likes, views, comments, downloads)}\n          </ul>\n        </div>\n      </li>\n    `\n    )\n    .join('');\n}\n\nfunction createImageDetailsMarkup(likes, views, comments, downloads) {\n  return `\n    <li class=\"detail-item\">\n      <h3 class=\"detail-label\">Likes</h3>\n      <p class=\"detail-value\">${likes}</p>\n    </li>\n    <li class=\"detail-item\">\n      <h3 class=\"detail-label\">Views</h3>\n      <p class=\"detail-value\">${views}</p>\n    </li>\n    <li class=\"detail-item\">\n      <h3 class=\"detail-label\">Comments</h3>\n      <p class=\"detail-value\">${comments}</p>\n    </li>\n    <li class=\"detail-item\">\n      <h3 class=\"detail-label\">Downloads</h3>\n      <p class=\"detail-value\">${downloads}</p>\n    </li>\n  `;\n}\n\nexport { displayImages };\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { fetchImages } from './js/pixabay-api';\nimport { displayImages } from './js/render-functions/';\n\nconst form = document.querySelector('.form');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.load-more-btn');\n\nconst errorToastSettings = {\n  messageColor: '#fafafb',\n  messageSize: '16px',\n  messageLineHeight: '1.5',\n  backgroundColor: '#ef4040',\n  position: 'topRight',\n  progressBarColor: '#b51b1b',\n};\n\nconst lightboxGallery = new SimpleLightbox('.gallery a', {});\n\nlet currentPage = 1;\nlet currentQuery = '';\n\nform.addEventListener('submit', handleSearch);\nloadMoreBtn.addEventListener('click', loadMore);\n\nasync function handleSearch(event) {\n  event.preventDefault();\n\n  const query = event.currentTarget[0].value.trim().toLowerCase();\n\n  if (!query) {\n    return;\n  }\n\n  if (query === currentQuery) {\n    return;\n  } else {\n    currentQuery = query;\n    currentPage = 1;\n  }\n\n  gallery.innerHTML = '';\n  loader.style.display = 'block';\n  loadMoreBtn.style.display = 'none';\n\n  try {\n    const data = await fetchImages(currentQuery, currentPage);\n\n    if (data.hits.length === 0) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        ...errorToastSettings,\n      });\n    } else {\n      displayImages(data.hits, gallery, lightboxGallery);\n\n      loadMoreBtn.style.display = 'block';\n    }\n  } catch {\n    iziToast.error({\n      message: 'An error occurred while fetching data. Please try again later.',\n      ...errorToastSettings,\n    });\n  } finally {\n    loader.style.display = 'none';\n  }\n}\n\nasync function loadMore() {\n  currentPage += 1;\n\n  loadMoreBtn.style.display = 'none';\n  loader.style.display = 'block';\n\n  try {\n    const data = await fetchImages(currentQuery, currentPage);\n\n    displayImages(data.hits, gallery, lightboxGallery);\n\n    const totalPages = Math.ceil(data.totalHits / 15);\n    if (currentPage >= totalPages) {\n      loadMoreBtn.style.display = 'none';\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    } else {\n      loadMoreBtn.style.display = 'block';\n    }\n  } catch {\n    iziToast.error({\n      message: 'An error occurred while fetching data. Please try again later.',\n      ...errorToastSettings,\n    });\n  } finally {\n    loader.style.display = 'none';\n  }\n}\n"],"names":["fetchImages","query","page","apiKey","axios","displayImages","images","gallery","lightboxGallery","createImageMarkup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","createImageDetailsMarkup","form","loader","loadMoreBtn","errorToastSettings","SimpleLightbox","currentPage","currentQuery","handleSearch","loadMore","event","data","iziToast","totalPages"],"mappings":"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"}